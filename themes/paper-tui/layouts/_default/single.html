{{ define "main" }}
<article>
  {{- $displayTitle := .Slug | default (.Title | urlize) -}}
  {{- $sectionURL := printf "/%s/" .Section -}}
  <h1 class="title-path mb-4"><a href="/" class="path-link">~</a>/<a href="{{ $sectionURL }}" class="path-link">..</a>/{{ $displayTitle }}</h1>

  <div class="text-xs text-text mb-8">
    <span class="mr-4">{{ .Date.Format "2006-01-02" }}</span>
    {{ with .Params.status }}
    <span class="mr-4">{{ . }}</span>
    {{ end }}
    {{ with .Params.tags }}
    <span class="mr-4">{{ delimit . ", " }}</span>
    {{ end }}
  </div>

  {{ if .Params.toc }}
  <nav class="toc mb-8 p-4 bg-code-bg rounded-sm">
    <h2 class="text-sm font-bold mb-2">Contents</h2>
    {{ .TableOfContents }}
  </nav>
  {{ end }}

  <div class="prose post-content leading-loose max-w-none">
    {{ .Content }}
  </div>

  {{ with .Params.repo }}
  <div class="mt-8 pt-4 border-t border-border text-sm">
    <span>Repository: </span><a href="{{ . }}" target="_blank" class="text-text break-all">{{ . }}</a>
  </div>
  {{ end }}

  <nav class="flex justify-between mt-12 pt-6 border-t border-border text-sm">
    <div>
      {{ with .PrevInSection }}
      <a href="{{ .RelPermalink }}" class="text-text no-underline">← {{ .Title }}</a>
      {{ end }}
    </div>
    <div>
      {{ with .NextInSection }}
      <a href="{{ .RelPermalink }}" class="text-text no-underline">{{ .Title }} →</a>
      {{ end }}
    </div>
  </nav>
</article>
{{ end }}
